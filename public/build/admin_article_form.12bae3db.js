"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[920],{2946:function(e,n,t){t(2675),t(9463),t(2259),t(5700),t(8706),t(2008),t(113),t(3792),t(8598),t(2062),t(739),t(9572),t(2892),t(4185),t(6099),t(3362),t(7764),t(958),t(2953);var r=t(1343),a=t(246),i=t(4692),o=t.n(i);function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function s(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c(r.key),r)}}function c(e){var n=function(e,n){if("object"!=l(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,n||"default");if("object"!=l(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==l(n)?n:n+""}r.m.autoDiscover=!1,o()(document).ready((function(){var e=o()(".js-user-autocomplete");(e.is(":disabled")||Promise.all([t.e(123),t.e(309)]).then(t.bind(t,3309)).then((function(n){n.default(e,"users","email")})),o()(".js-reference-list")[0])&&function(e){var n=document.querySelector(".js-reference-dropzone");if(!n)return;new r.m(n,{paramName:"reference",init:function(){this.on("success",(function(n,t){e.addReference(t)})),this.on("error",(function(e,n){n.detail&&this.emit("error",e,n.detail)}))}})}(new u(o()(".js-reference-list")));var n=o()(".js-article-form-location"),a=o()(".js-specific-location-target");n.on("change",(function(e){o().ajax({url:n.data("specific-location-url"),data:{location:n.val()},success:function(e){if(!e)return a.find("select").remove(),void a.addClass("d-none");a.html(e).removeClass("d-none")}})}))}));var u=function(){return e=function e(n){var t=this;!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),new WeakSet([]),this.$element=n,this.sortable=a.Ay.create(this.$element[0],{handle:".drag-handle",animation:150,onEnd:function(){o().ajax({url:t.$element.data("url")+"/reorder",method:"POST",data:JSON.stringify(t.sortable.toArray())})}}),this.references=[],this.render(),this.$element.on("click",".js-reference-delete",(function(e){t.handleReferenceDelete(e)})),this.$element.on("blur",".js-edit-filename",(function(e){t.handleReferenceEditFilename(e)})),o().ajax({url:this.$element.data("url")}).then((function(e){t.references=e,t.render()}))},(n=[{key:"addReference",value:function(e){this.references.push(e),this.render()}},{key:"handleReferenceDelete",value:function(e){var n=this,t=o()(e.currentTarget).closest(".list-group-item"),r=t.data("id");t.addClass("disabled"),o().ajax({url:"/admin/article/references/"+r,method:"DELETE"}).then((function(){n.references=n.references.filter((function(e){return e.id!==r})),n.render()}))}},{key:"handleReferenceEditFilename",value:function(e){var n=o()(e.currentTarget).closest(".list-group-item").data("id"),t=this.references.find((function(e){return e.id===n}));t.originalFilename=o()(e.currentTarget).val(),o().ajax({url:"/admin/article/references/"+n,method:"PUT",data:JSON.stringify(t)})}},{key:"render",value:function(){var e=this.references.map((function(e){return'\n<li class="list-group-item d-flex justify-content-between align-items-center" data-id="'.concat(e.id,'">\n    <span class="drag-handle fa fa-reorder"></span>\n    <input type="text" value="').concat(e.originalFilename,'" class="form-control js-edit-filename" style="width: auto;">\n\n    <span>\n        <a href="/admin/article/references/').concat(e.id,'/download" class="btn btn-link btn-sm"><span class="fa fa-download" style="vertical-align: middle"></span></a>\n        <button class="js-reference-delete btn btn-link btn-sm"><span class="fa fa-trash"></span></button>\n    </span>\n</li>\n')}));this.$element.html(e.join(""))}}])&&s(e.prototype,n),t&&s(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,n,t}()}},function(e){e.O(0,[692,134,177],(function(){return n=2946,e(e.s=n);var n}));e.O()}]);